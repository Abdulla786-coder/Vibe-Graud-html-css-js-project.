<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Scanner â€“ VibeGuard</title>
    <meta name="description"
        content="Paste or upload your AI-generated code and get a full security audit in seconds." />
    <link rel="stylesheet" href="css/styles.css" />
    <link rel="icon"
        href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>ğŸ›¡ï¸</text></svg>" />
</head>

<body>

    <div class="bg-mesh"></div>
    <div class="particles" id="particles"></div>

    <!-- Navbar -->
    <nav class="navbar">
        <a href="index.html" class="nav-logo">
            <div class="logo-icon">ğŸ›¡ï¸</div>
            <span class="logo-text">Vibe<span>Guard</span></span>
        </a>
        <div class="nav-links">
            <a href="index.html">Home</a>
            <a href="scan.html" class="active">Scanner</a>
            <a href="history.html">History</a>
        </div>
        <a href="history.html" class="nav-cta">ğŸ“‹ History</a>
    </nav>

    <div class="page-wrapper">
        <div class="scan-header">
            <h1>âš¡ Code Scanner</h1>
            <p>Paste your AI-generated code, select the language, and run a full audit.</p>
        </div>

        <div class="scan-layout" style="grid-template-columns:1fr 340px;max-width:1200px">

            <!-- Left: Editor -->
            <div style="display:flex;flex-direction:column;gap:1.25rem;">
                <div class="scan-card">
                    <div class="scan-toolbar">
                        <select class="select-lang" id="lang-select">
                            <option value="javascript">JavaScript</option>
                            <option value="typescript">TypeScript</option>
                            <option value="python">Python</option>
                        </select>
                        <label for="file-input" class="upload-btn">ğŸ“ Upload File</label>
                        <input type="file" id="file-input" accept=".js,.ts,.jsx,.tsx,.py" />
                        <span class="line-count" id="line-count">0 lines</span>
                    </div>

                    <div class="editor-wrapper">
                        <div class="editor-header">
                            <div class="dot-red"></div>
                            <div class="dot-yellow"></div>
                            <div class="dot-green"></div>
                            <span class="editor-lang-badge" id="editor-lang-badge">javascript</span>
                        </div>
                        <textarea class="code-textarea" id="code-input" spellcheck="false" placeholder="// Paste your AI-generated code here...
// Example:
const password = 'admin123';
const query = 'SELECT * FROM users WHERE id=' + userId;
document.getElementById('output').innerHTML = userInput;
eval(userInput);"></textarea>
                    </div>

                    <button class="analyze-btn" id="analyze-btn">
                        <span id="btn-icon">ğŸ”</span>
                        <span id="btn-text">Analyze Code</span>
                    </button>
                </div>

                <!-- Progress -->
                <div class="scan-progress" id="scan-progress">
                    <div class="progress-steps">
                        <div class="progress-step" id="step-sast">
                            <div class="step-icon">â—·</div>
                            <span>Running Static Analysis (SAST)â€¦</span>
                        </div>
                        <div class="progress-step" id="step-ai">
                            <div class="step-icon">â—·</div>
                            <span>Running LLM Logic Auditâ€¦</span>
                        </div>
                        <div class="progress-step" id="step-score">
                            <div class="step-icon">â—·</div>
                            <span>Calculating Quality Scoreâ€¦</span>
                        </div>
                        <div class="progress-step" id="step-road">
                            <div class="step-icon">â—·</div>
                            <span>Generating Refactoring Roadmapâ€¦</span>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Right: Settings Panel -->
            <div style="display:flex;flex-direction:column;gap:1.25rem;">

                <!-- API Key -->
                <div class="api-section">
                    <h3>ğŸ¤– OpenAI API Key <span
                            style="font-size:0.75rem;font-weight:400;color:var(--text-muted)">(optional)</span></h3>
                    <p>Enables GPT-4o logic audit for hallucination detection. Without it, SAST-only mode runs
                        instantly.</p>
                    <div class="api-input-row">
                        <input type="password" class="api-input" id="api-key-input" placeholder="sk-..." />
                        <button class="save-btn" id="save-api-btn">Save</button>
                    </div>
                    <div class="api-status missing" id="api-status">âš  No key saved â€” SAST-only mode</div>
                </div>

                <!-- Quick Guide -->
                <div class="scan-card">
                    <h3
                        style="font-size:1rem;font-weight:700;margin-bottom:1rem;display:flex;align-items:center;gap:8px;">
                        ğŸ¯ What Gets Checked</h3>
                    <div
                        style="display:flex;flex-direction:column;gap:0.6rem;font-size:0.85rem;color:var(--text-secondary);">
                        <div style="display:flex;align-items:center;gap:8px;"><span style="color:#ef4444;">ğŸ”´</span>
                            Hardcoded credentials & API keys</div>
                        <div style="display:flex;align-items:center;gap:8px;"><span style="color:#ef4444;">ğŸ”´</span> SQL
                            Injection patterns</div>
                        <div style="display:flex;align-items:center;gap:8px;"><span style="color:#ef4444;">ğŸ”´</span>
                            Pickle deserialization (Python)</div>
                        <div style="display:flex;align-items:center;gap:8px;"><span style="color:#f97316;">ğŸŸ </span> XSS
                            via innerHTML</div>
                        <div style="display:flex;align-items:center;gap:8px;"><span style="color:#f97316;">ğŸŸ </span>
                            eval() & exec() usage</div>
                        <div style="display:flex;align-items:center;gap:8px;"><span style="color:#f97316;">ğŸŸ </span>
                            os.system() shell injection</div>
                        <div style="display:flex;align-items:center;gap:8px;"><span style="color:#f97316;">ğŸŸ </span>
                            Weak hashing (MD5/SHA1)</div>
                        <div style="display:flex;align-items:center;gap:8px;"><span style="color:#f97316;">ğŸŸ </span>
                            DEBUG mode enabled</div>
                        <div style="display:flex;align-items:center;gap:8px;"><span style="color:#f59e0b;">ğŸŸ¡</span>
                            Insecure Math.random()</div>
                        <div style="display:flex;align-items:center;gap:8px;"><span style="color:#f59e0b;">ğŸŸ¡</span>
                            HTTP (non-HTTPS) usage</div>
                        <div style="display:flex;align-items:center;gap:8px;"><span style="color:#10b981;">ğŸŸ¢</span>
                            console.log in prod</div>
                        <div style="display:flex;align-items:center;gap:8px;"><span style="color:#10b981;">ğŸŸ¢</span>
                            TODO/FIXME/HACK comments</div>
                        <div style="display:flex;align-items:center;gap:8px;"><span style="color:#93c5fd;">ğŸ”µ</span> +
                            AI Logic Hallucinations (with key)</div>
                    </div>
                </div>

                <!-- Try Sample -->
                <div class="scan-card">
                    <h3 style="font-size:1rem;font-weight:700;margin-bottom:0.75rem;">ğŸ’¡ Try a Sample</h3>
                    <p style="font-size:0.85rem;color:var(--text-muted);margin-bottom:1rem;">Load a pre-made vulnerable
                        snippet to see VibeGuard in action.</p>
                    <div style="display:flex;flex-direction:column;gap:0.6rem;">
                        <button class="export-btn" onclick="loadSample('js')" style="justify-content:center;">JavaScript
                            Sample (Vulnerable)</button>
                        <button class="export-btn" onclick="loadSample('py')" style="justify-content:center;">Python
                            Sample (Vulnerable)</button>
                        <button class="export-btn" onclick="loadSample('clean')" style="justify-content:center;">Clean
                            Code Sample</button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script src="js/sast-engine.js"></script>
    <script src="js/openai-audit.js"></script>
    <script src="js/scoring.js"></script>
    <script src="js/roadmap.js"></script>
    <script src="js/scan.js"></script>
    <script>
        // Particles
        (function () {
            const c = document.getElementById('particles');
            ['#7c3aed', '#00e5ff', '#ec4899'].forEach((col, i) => {
                for (let j = 0; j < 6; j++) {
                    const p = document.createElement('div'); p.className = 'particle';
                    const s = Math.random() * 2 + 1;
                    p.style.cssText = `width:${s}px;height:${s}px;left:${Math.random() * 100}%;background:${col};animation-duration:${Math.random() * 20 + 12}s;animation-delay:${Math.random() * 10}s;`;
                    c.appendChild(p);
                }
            });
        })();
    </script>
</body>

</html>